<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Manage Chatroom - WhatsApp SN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<nav th:replace="~{fragments/navbar.html :: navbar}"> </nav>

<div class="container my-5">
    <a th:href="@{/chatrooms/{id}/view-chatroom(id=${chatroom.id})}" class="btn btn-secondary mb-4">Back</a>
    <form th:action="@{/chatrooms/leave/{id}(id=${chatroomId})}" method="post" class="d-inline">
        <button type="submit" class="btn btn-danger">Leave Chatroom</button>
    </form>

    <h2>
        <div style="color: red;">DEBUG editNameMode: <span th:text="${editNameMode}"></span></div>
        <span th:if="${chatroom.type == T(com.app.model.ChatroomType).GROUP and chatroom.editableName}">
        <span th:if="${!editNameMode}">
            <span th:text="${chatroom.name}">Chatroom Name</span>
            <a th:href="@{'/chatrooms/' + ${chatroom.id} + '/manage?(editName=true)'}" class="btn btn-secondary btn-sm ms-2">Edit</a>
        </span>
        <span th:if="${editNameMode}">
            <form th:action="@{/chatrooms/{id}/edit(id=${chatroom.id})}" method="post" class="d-inline">
                <input type="text" name="name" th:value="${chatroom.name}" required
                       class="form-control d-inline-block w-auto" style="display: inline; width: auto;" />
                <button type="submit" class="btn btn-primary btn-sm">Save</button>
            </form>
        </span>
    </span>
        <span th:if="${!(chatroom.type == T(com.app.model.ChatroomType).GROUP and chatroom.editableName)}" th:text="${chatroom.name}">Chatroom Name</span>
    </h2>


    <div th:replace="~{fragments/chatroom/chatroom-managment :: chatroomManagment(${chatroomType}, ${chatroomId}, ${editNameMode})}"></div>
</div>

<footer th:replace="~{fragments/footer.html :: footer}"> </footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
